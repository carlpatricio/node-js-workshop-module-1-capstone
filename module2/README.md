# NodeJS Foundation Workshop

## Module 2 Mini Project

The application will simulate real-time data ingestion, have CRUD functionalities, and send notifications (email or SMS) when sensor data hits certain thresholds. Proper logging, data validation, and error handling will be integral parts of the project.

## Dependencies

Module 2 uses a number of open source projects to work properly:

- `nodemon` - Simple monitor script for use during development of a Node.js app
- `node-cron` - is tiny task scheduler in pure JavaScript for node.js based on GNU crontab.
- `express` - Fast, unopinionated, minimalist web framework for Node.js.
- `Joi` - used for validation
- `dotenv` - loads environment variables from a .env file into process.env
- `winston` - iss designed to be a simple and universal logging library with support for multiple transports
- `@sendgrid/mail` - Twilio SendGrid NodeJS mail service
- `swagger-ui-express` - Used to serve Swagger API Docs
- `yamljs` - Used to load swagger.yaml

## Pre-requisities

Install this tools before proceeding to the project itself.

- `run-rs` - starts a replica set with no non-Node dependencies, not even MongoDB. [For reference](https://www.npmjs.com/package/run-rs)
  #### NOTE: You need this if you're going to using MongoDB locally, you may skip this part by setting the `NODE_ENV: prod` so that this app will use the `MongoDB Atlas`
  ```sh
  #to install
  npm i -g run-rs
  #to run, you can get the MONGODB_URI_DEV value in here
  run-rs
  ```
- `MongoDB Compass` - the GUI for MongoDB [Download here](https://www.mongodb.com/try/download/compass)
- `SendGrid` - delivers your transactional and marketing emails through the world's largest cloud-based email delivery platform [Reference here](https://sendgrid.com/)
  #### NOTE: Need to set up this one to fill up one of the env var `SEND_GRID_API_KEY` generated by SendGrid upon setting up of account
- `NodeJS` - JavaScript runtime built on Chrome's V8 JavaScript engine. [Download here](https://nodejs.org/en/download/current)

## Installation

Install the dependencies and devDependencies and start the server.

```sh
cd module2
npm i
```

Create a `.env` file in the root of your project and insert
your key/value pairs in the following format of `KEY=VALUE`:

You may get my env file in [here](https://glib-cost-edd.notion.site/ENV-Files-19b164c26c60488381db4698be8d55b4?pvs=4)

```sh
NNODE_ENV=dev/prod
SERVER_PORT=5858

MONGODB_DB_NAME=module2
MONGODB_URI_DEV=mongodb://<hostname>:27017,<hostname>:27018,<hostname>:27019/?replicaSet=rs #generated by run-rs
MONGODB_URI_PROD=mongodb+srv://<user>:<password>@testcluster.oytwk2v.mongodb.net #from the MongoDB Atlas cluster

SEND_GRID_API_KEY=sendGridApiKey #generated upon setting up of SendGrid
RECEIVER_EMAIL=receiverEmail@example.com #the one who will receive email notif
SENDER_EMAIL=senderEmail@example.com #need to define it as sender in the SendGrid dashboard
```

## Development

Open your favorite Terminal and run these commands.

run-rs:

```sh
run-rs #run this if you're going to use MongoDB locally before starting the app
```

Sensor Simulator:

```sh
yarn start:sensor
```

Main Server App:

```sh
yarn start:dev or yarn start:watch
```
